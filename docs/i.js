const js13k={DEBUG:!1,FONT:'"Courier New", monospace',TARGET_FPS:60,circleOverlap:(a,e)=>(a.x-e.x)*(a.x-e.x)+(a.y-e.y)*(a.y-e.y)<(a.r+e.r)*(a.r+e.r),getTextAlpha:a=>.1+.5*(Math.sin(a/40)+1)*.9,init(){js13k.Input.init(),js13k.Audio.init(),js13k.Renderer.init((()=>{js13k.Renderer.level=new js13k.Level.Intro,js13k.Renderer.mainLoop()}))},normalize(a){const e=Math.sqrt(a[0]*a[0]+a[1]*a[1]);return a[0]/=e||1,a[1]/=e||1,[a,e]},shuffle(a){for(let e=a.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[a[e],a[t]]=[a[t],a[e]]}return a}};window.addEventListener("load",(()=>js13k.init())),js13k.Assets={sprites:{bg_eye_ball:{data:"                                     aaaaa                                                                                aaaaaaaaaaaaaaaaaa                                                                     aaaaaaa        aaaaaaaaaa                                                              aaaa                  aaaa aaa                                                         aaa                        aaaa aaa                                                    aaaa                            aaaa aa                                                aaaa                                 aaa aa                                            aaaa                                     aaa aa                                         aaa                                         aaa a                                       aaa                                            aaaa                                    aaaa                                               aaaa                                 aaaa                                                 aaaa                               aaa                                                     aaa                             aaa                                                       aaa                           aa                                                           aa                         aa                                                             aa                       aa                                                               aa                     aa                                                                aaa                   aa                                                                  aaa                 aa                                                                     aa                a                                                                       aa              aa                                                                        aa            aa                                                                          a            a                                                                           aa          aa                                                                            aa         a                                                                             aa        aa                                                                              a        a                                                                               aa      aa                                                                                a      aa                                                                                a      a                                                                                 a     aa                                                                                 aa    aa                                                                                  a    a                                                                                   a   aa                                                                                   aa  aa                                                                                   aa  aa                                                                                   aa  aa                                                                                   aa  a                                                                                    aa aa                                                                                    a aaa                                                                                    a aaa                                                                                    a aa                                                                                     a aa                                                                                     aaaa                                                                                      aaa                                                                                      aaa                                                                                      aaa                                                                                      aaa                                                                                      aaa                                                                                      aaa                                                                                      aaa                                                                                      aaaa                                                                                    aa aa                                                                                    aa  a                                                                                    aa  a                                                                                    aa  a                                                                                    aa  aa                                                                                   a    a                                                                                  aa    aa                                                                                 aa     a                                                                                 a      aa                                                                               aa      aa                                                                               aa       a                                                                               a        aa                                                                             aa         aa                                                                            a          aa                                                                           aa           aa                                                                         aa            aa                                                                         aa             aa                                                                       aa               a                                                                       a                aa                                                                     aa                 a                                                                     a                  aa                                                                   aa                   aa                                                                 aa                     aa                                                               aa                       aa                                                             aaa                        aa                                                           aaa                          aa                                                         aaa                             aa                                                      aaa                               aaa                                                  aaaa                                  aa                                                aaaa                                    aaaa                                            aaa                                       aaaa                                         aaaa                                          aaaaa                                    aaaa                                              aaaaaa                               aaaaa                                                 aaaaaaa                         aaaaaa                                                      aaaaaaa                   aaaaaaa                                                           aaaaaaaaaaaa      aaaaaaaaa                                                                   aaaaaaaaaaaaaaaaa                                  ",c:{a:[255,255,255,255]},s:[89,90]},bg_eye_blood:{data:"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              aa                                                  a                                   aa                                                   aa                                   a                                                   a                                    a                                                  aa                                    aa                                                aaa                                    a  a                                              a a                                    a aaa                                            a aa                            aa      aa                                                       aaa                      aaa     a                                                     aaa                          aaa   a                                                     a                              a                                                         a                              a                                                         a       a                      a                                                        aa      aa             aa       aa                                                      aa      aa               aa       aaa                                                     a    aaa                 aaaa    a a                                                     a                                                                                                                                                                                                                                                                                                                                                                        aaa                 aaaa                                                                   aaaa           aaaa                                                                      aa aaaa      aaa aa                                                                     aa                 aa                                                                   aa                   aa                                                                  a                     aaa                                                                                                                                                                                                                                                                                                                                            a                   a                                                                   aa     aa    aaa     a                                                                     aaaaaa       aaaaaaaaa                                                                   a  aa         aa  a  aa                                                                      aa       aa       a                                                                       aa     aa                                                                                 aa   aa                                                                                                                                                                                                                                                                                                                                                      aa                 aa                                                                   aa                   aaa                                                                aaaa                 aaaaa                                                               a  aaaaa         aaaaa   a                                                                      aaa     aaa                                                                         a                   a                                                                    aa                 aa                                                                     aa    a          aa                                                                       aa aa        a aa                                                                      aaaaaa         aaaaaa                                                                                                                                                                                                                                                                                                                                           a                            a                                                           aa                          aa                                                            aa aaaa              aaa  aa                                                              aaa                   aaaa                                                                                                                                                                                                                                                                                                                                     aa                                aa                                                      a                                a                                                       a                                a                                                       aaa                            aaa                                                         a                            a                                                    a                                           a                                            aa                                        aaa                                             a                                         a                                              a                                         a                                              aa                                       aa                                      aaaaa    a                                            aa                                    aa                                                 aa                                    a                                                   a                                    a                                                                                        a                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ",c:{a:[255,255,255,255]},s:[89,90]},bg_eye_iris:{data:"         a                 aa                 aaa              aaa a              aaaaaa            aaa aaaa          aaa  aaaa          aaa   aaa         aaa    aaaa        aa      aaa       aaa       aaa      aa        aaa      aa         aaa    aa          aaa    aa           aa    aa           aaa   aa           aaa   aa            aaa aaa            aaa a a            aaa aaa            aaa aaa             aaaaaa             aaaaaa             aaaaaa             aaaa a             aaaa a             aaaa a             aaaaaa             aa  aa             aa  aa            aaa  aa            aaa   a            aa    a            aa    aa          aa     aa          aa      a          a       aa         a        a         a        a        aa        aa       aa        aa      aaa         aa     aa          aaa   aaa          aaa   aa            aa  aa             aaaaa               aaa                aaa                 a          ",c:{a:[255,255,255,255]},s:[19,50]},bite_small:{data:"                          aaa                      a  a aaaaaa                              aaa                              aa                              aa                               aaa                            aaaaa         a       aa        aaa aa      aaa      aaaa       aaa aaa    aaaa     aaaaa       aaa  aaa  aaaaaa    aa aaa      aaa  aaa  aaa aa    aa aaaa     aa    aa aaaa  a    aa  aaa     aa    aaaaaa   aa  aa   aaaa    aa    aaaaa     aaaa     aaa    aa    aaaa      aaaa     aaa   aaa    aa        aaa      aaa   aaa               a       aaa   aa                        aaa   aa                        aaa   aa                        aaa   a                         aaa  aa                         aaa  a                          aaa  a                          aaa aa                          aa aaa                         aaa aa                          aaaaa                           aaaa                            aaa                             aa                              a          ",c:{a:[255,255,255,255]},s:[32,32]},br_eye:{data:"aaa             aaaaa           aaaaaaa         aaa   aaa       aa      aa      a        aa     a      aaaaa    a     aaa  a    a    aa aa aa        a   aa a       aa    a  a      aa       aa    aaaaa    aaa    a   aa   aaaa   a        aa a   a        aa a   aaaa     aa a   a  aaaa  aa a   a        aa a   a        aaaa   aa    aa  aaa    aa  aa   aa      aaaa  a  a       a    a aa a     aa aa aa  a      aaa aa   a        aaa    a        aa     aa     aaa      aaaa aaa        aaaaaa          aaaa            ",c:{a:[60,119,147,255]},s:[16,32]},br_tooth:{data:"aa                            aaaaaaaaaa                    aaaaaaaaaaaaaaaa              aaaa        aaaaaaa           aaa             aaaaaa        aaa                aaaaaa     aa                    aaaa    aa                      aaa   aa                       aaaa aa                aaaaaaaaaaa aaa       aaaaaaaaaaaaaaaaaaaaaaa   aaaaaaa                 aaaaaaaa                      aaaa                          aaa                           aa                            ",c:{a:[60,119,147,255]},s:[30,16]},eye:{data:"                         aaaaaaaaaaaa                                                aaaaaaaaaaaa                                               aaaaaaaaaaaaaaaaa                                            aaaaaaaaaaaaaaaaa                                         aaaaaaaaaa   aaaaaaaaa                                        aaaaaaaa   aaaaaaaaaaa                                     aaaaaaaaaa      aaaaaaaaa                                    aaaaaaaaa      aaaaaaaaaa                                  aaaa aaaaaaaaa   aaaaaaaaaaaa                                aaaaaaaaaaaaa   aaaaaaaa aaaa                               aaa    aaaaaaaaaaaaaaaaaaa aaaa                              aaaa aaaaaaaaaaaaaaaaaaa    aaa                            aaaa      aaaaaaaaaaaaaaaaa    aaaa                          aaaa    aaaaaaaaaaaaaaaaa      aaaa                         aaaa        aaaaaaaaaaaaaaa      aaaa                        aaaa      aaaaaaaaaaaaaaa        aaaa                      aaa aa          aaaaaaaaaaa          aaa                      aaa          aaaaaaaaaaa          aa aaa                   aa  aaaa                              aaaa                    aaaa                              aaaa  aa                 aa  aaa aa                             aaaaa                  aaaaa                             aa aaa  aa               aa aaa  a a                            aa  aaa                aaa  aa                            a a  aaa aa             aaaaa    a aa                          aaa    aa              aa    aaa                          aa a    aaaaa           aa  aa   aaaaaaa                       aaaaaaaaaaa            aaaaaaaaaaa                       aaaaaaa   aa  aa          a  aa   aaa aaaaa                    aaa   aaaa  aa          aa  aaaa   aaa                    aaaaa aaa   aa  a         aa aa    a a   aaaaa                aaaaa      aa  aa        aa  aa      aaaaa                aaaaa   a a    aa aa        a  a     a aa  a aaaaa            aaaa  aa      aa  aa      aa  aa      aa  aaaa            aaaaa a  aa a     a  a       aa  a   aaa  a aa  aaaaaaaaaaaaaaaaa a    aaa     a   a      a   a     aaa    a aaaaaaaaaaaaaaaaa  aa a  aaa   a  aa      a      aa      a    aa      a     a  a    a aa    a   aa    aa   a    aa a    a  a     a      aa    a      aa      a     aa              a   aaa      a     a  a    a  a        aa    aa        a  a    a  a     a      aa    a              aa    a              aa   a aa    aaa    aa aa      a         a    a         a      aa  a    aa     aaa    aa              a    aaa          aaa    a  aa   a a   aaa  aaa    a         aa  aa         a    aaa  aaa   a a   aa a     aaa          aaa   aaa                  a   a   a aa    a    a               a  a               a    a    aa a   a  a                   aaa  aaa                 aa   a   a  a    aa   a               a  a               a    aa   a      a  aa                  aaa  aaaaa               a        a        a                   a  a                     a              a                aaaaa  aaaa  a                                             aa    a  a    aa                                             a  aaaa aaaa  aa                                              aa a  aa  a aa                                              aa  aaaaaaaa  a   a                                         a  a a  aa  a a  a                                         a   a  aaaaaaaa  a   aa                                        a  a a  aa  a a  a                                        aa   a  aaaaa a  aa   aa      a                                 aa aaa  aa  aaa aa                                 a      aa   aa  a aa a  a   aa      aa                       a     a    a  aa  aa  aa  a    a     a                       aa      aa   a  a aaaa  a   aa     aa     aa     a           aa    a    a  aa  aa  aa  a    a    aa           a     aa     aa     aa   a  aaaaaa  a   aa    aa      a      a            a    a    aa  aa aa aa  aa    a    a            a      a      aa    aa   a  aaaaaaaaa  aaa    a      aa      a      a     a    a     a  aa aa aa  a     a    a     a      a      aa      a    aaa  aaaaaaaa aa   a a   aa      aa      a      a     aa   a     a  aa aa aa  a     a   aa     a      a      aa      aa   a a   aa aaaa aa   a a   a       a      aa      a      a   a     a  aa aa aa  a     a   a      a      aa      a       a   a a   aa aaaa aa a a a   a  aa  aa      a a  a  a   a  a   a  a  a  aaaaaaaa  a  a  a   a  a   a  a  a a      aa  aa  a   a a a aa aa a aaaaa  a   a  a   aa   a  a a  a  a   a  a   a  a  a  a a  a a  a  a  a   a  a   a  a  a a  a   aa   a  a   a  aaaaa a  aa aaaa  a   a aa   aa  aa  a a  a  a   a  a   a  a  a aa a  a aa a  a  a   a  a   a  a  a a  aa  aa   aa a   a  aaaa aa  aaaaaaaaaa   a a    aa  a   a a  a  a   aa a   a  a  aaaaaa  aaaaaa  a  a   a aa   a  a  a a   a  aa    a a   aaaaaaaaaa  aaaaaaaaaa   aaaa   aa  a  aa a  a  aa   a a   a aa  aaaaaa  aaaaaa  aa a   a a   aa  a  a aa  a  aa   aaaa   aaaaaaaaaa  aaaaaaaaaa   aa a    a aa  aa a  a  aa   a a   a aa  aaaaaa  aaaaaa  aa a   a a   aa  a  a aa  aa a    a aa   aaaaaaaaaa  aaaaaaaaaa aaaa aa   a a  aaa a  aa aaa  aaa a a aa aaaaaa    aaaaaa aa a a aaa  aaa aa  a aaa  a a   aa aaaa aaaaaaaaaa  aaaaaaaaaa aaaa aa   a aa aaa a  aa aaaa aa  aaaaaa aaaaaa    aaaaaa aaaaaa  aa aaaa aa  a aaa aa a   aa aaaa aaaaaaaaaa  aaaaaaaaaa aaaaaaa   aaaaaa a aaaaaa aaaaaa  aaaaaaaaaaaaa    aaaaaaaaaaaaa  aaaaaa aaaaaa a aaaaaa   aaaaaaa aaaaaaaaaa   aaa aaaaa aaaaaaa  aaaaaaa aaaaaa   aaaaa   a aaa aaaaaaa    aaaaaaa aaa a   aaaaa   aaaaaa aaaaaaa  aaaaaaa aaaaa aaa    aaa aaaaa aaaaaaa  aaaaaaa  a aaaa  aaaaa   aaaa aaaaaaa      aaaaaaa aaaa   aaaaa  aaaa a  aaaaaaa  aaaaaaa aaaaa aaa    aaaa aaaaaaaaaaaaaaaaaaaaa aa aaaa  aaaaa   aaa aaaaaaaa      aaaaaaaa aaa   aaaaa  aaaa aa aaaaaaaaaaaaaaaaaaaaa aaaa    aaaa aaaaaaaaa  aaaaaaaaaaaaa aaaa aaaaaa   aaa a aaaaaa      aaaaaa a aaa   aaaaaa aaaa aaaaaaaaaaaaa  aaaaaaaaa aaaa    aaaaa aa aa aa  aaaa a a aa a aaaa aaaaaaa  aaa aaaaaaa        aaaaaaa aaa  aaaaaaa aaaa a aa a a aaaa  aa aa aa aaaaa    aaaaaaaa aa a a aaa  a a aa aaaaaaaaaaaaaa  aaaaaaaaaa          aaaaaaaaaa  aaaaaaaaaaaaaa aa a a  aaa a a aa aaaaaaaa    aaa a aa aa a a aaa  a a aa aaaaaaaaaaaaa   aa a aaaa            aaaa a aa   aaaaaaaaaaaaa aa a a  aaa a a aa aa a aaa     aa aaaa aa aaa  aaa aaaaaaaaaaaa aaa a a   a  aaaa a            a aaaa  a   a a aaa aaaaaaaaaaaa aaa  aaa aa aaaa aa      aaa aaaaaa  aa  aaa  aaaaaa aaaa aaaaa a   a  aaaaaa            aaaaaa  a   a aaaaa aaaa aaaaaa  aaa  aa  aaaaaa aaa      aaa  aa aa  aa  aaaaaaaaaaa aaaa  aaaa a  aa aaaa aa            aa aaaa aa  a aaaa  aaaa aaaaaaaaaaa  aa  aa aa  aaa      aaa  aaaaa   a  aaa aaaaa a aaaa  aaaaaa  aaaa aaaa              aaaa aaaa  aaaaaa  aaaa a aaaaa aaa  a   aaaaa  aaa      aaaa  aaaaaa aa aaaaaaaaa aaaa a  aaa a   aaaaaaaaa              aaaaaaaaa   a aaa  a aaaa aaaaaaaaa aa aaaaaa  aaaa      aaaa  a aaa a a aa aaaaaaaaa a a  aaa a   aaaaaaa a             aa aaaaaaa   a aaa  a a aaaaaaaaa aa a a aaa a  aaaa      aaaa  aaaaaaaaaaaa aaaaaaaa aa a  aa aaaaaaaa aaaa              aaaaaa aaaaaaaa aa  a aa aaaaaaaa aaaaaaaaaaaa  aaaa      a aaa aa aa aaaaaaaaaaaaaaa aa a  aa aaaaaa a aaaa               aaaaa a aaaaaa aa  a aa aaaaaaaaaaaaaaa aa aa aaa a        aaa  a  aa   aaaaaaaaaaaa a  a aaaaaaa  aaa aaaa               aaaaa aaa  aaaaaaa a  a aaaaaaaaaaaa   aa  a  aaa          aaaaaa  aaa  aa aaa aaaaaaaaaaaaaaaa   aaa  a a                a a a  aaa   aaaaaaaaaaaaaaaa aaa aa  aaa  aaaaaa          aaaaaaa a aa aa aaa aaaaa a a  a a a   aaa aaaaa               a aaaa aaa   a a a  a a aaaaa aaa aa aa a aaaaaaa          aaaaaaa a  a aa  aaaaa aaaa a  aaa a   a a aaaaa               a aaaa a a   a aaa  a aaaa aaaaa  aa a  a aaaaaaa          a aaaaa aa aaaa aaaa a aaaa a  aa aaaa a aaaaa a               a aaaaaa a aaaa aa  a aaaa a aaaa aaaa aa aaaaa            a aaa aaaa  aaaaa aa aaaaaa a  aa aaa  aaaa a  a               a a a aaaa  aaa aa  a aaaaaa aa aaaaa  aaaa aaaa           a aaaaaaaa  aaaaa aaa aa aa a  aa aa   aaaaaa  a               a a aaaaaa   aa aa  a aa aa aaa aaaaa  aaaaaaaaa           a a aaaaaa   aaaaaaaa aa aa a  aa aa  aaaa a   aa              aaa  a aaaa  aa aa  a aa aa aaaaaaaa   aaaaaa  a           aaa  aa aa   aaaaa aaaaa aaaa  a aa   aaaaaa   a               aa   aaaaaa   aa a  aaaa aaaaa aaaaa   aa aa   aa          aa   aaaaa   aaaaa a aaa aaaa  a aa   aaa aa   a               a    aa aaa   aa a  aaaa aaa a aaaaa   aaaaa    a          aa    aaaa   aaaaa aaaaa a aa aaaa   aaaaaa   a               aaa    aaaaaa   aaaa aa a aaaaa aaaaa   aaaa     a           a    aaaaa   aaaa  aaaa a aa a aa   a aaaa                   a a    aaaa a   aa a aa a aaaa  aaaa   aaaaa    aa           a    aaaaa   aaaa  aaaa a aa aaaa   aaaaaa                   a aa   aaaaaa   aaaa aa a aaaa  aaaa   aaaaa    a           aaa   aaaaa    aa   aaaa a aaaaaaa  aaaaaaa                   a  a   aaaaaaa  aaaaaaa a aaaa   aa    aaaaa                a aa  aaaaaa   aa   aaaaaa aaaaaa   aa aaaa                   aa a   aaaa aa   aaaaaa aaaaaa   aa   aaaaaa                a  a   aaaaa   aaa  aaaaaa a aa a   aa aaa                     a a    aaa aa   a aa a aaaaaa  aaa   aaaaa                 a  a   aaaaa   aaa   aaaaa aaaa a  aa aaaa                     a a    aaaa aa  a aaaa aaaaa   aaa   aaaaa                 a  aa   aaaaa  aaa   aaaaa aaa aa aaaaaaaa                       aa   aaaaaaaa aa aaa aaaaa   aaa  aaaaa                      a   aaaaa  aaa   aa aa aaa a  aa aaaaa                        a   aaaaa aa  a aaa aa aa   aaa  aaaaa                      aa   aaaaa aaaa  aa aa a aa  aa aaaaaa                       aa   aaaaaa aa  aa a aa aa  aaaa aaaaa                        a   a aaa a aa  aa aa aaaa  aaaaaa aa                             a aaaaaa  aaaa aa aa  aa a aaa a                        a    aaaa a aaa aa aa aaaa aa aaaaaaa                             aaaaaa aa aaaa aa aa aaa a aaaaa                        a    aaaa a aaa aa aaaaaa  aaaaaaaa a                              aaaaaaaa  aaaaaa aa aaa a aaaaa                              aaaaaa aa aa aaaaaa aa aaaaaa a                              aaaaaa aa aaaaaa aa aa aaaaaaaa                              aaaaaa aaaa  aaaaaa aaa aaaa  a                               aaaa aaa aaaaaa  aaaa aaaaaaa                               aaaaaa  aaa  aaaaa aaaa aa a  a                                 aa aaaa aaaaa  aaa  aaaaaaa                               aa aa a aaa  aaaaa aaa aaa a  a                                 aaa aaa aaaaa  aaa a aa aaa                                aaaa aaaaa  aaaaaaaaaaaa aa  aa                                 aaaaaaaaaaaa  aaaaa aaaa a                                aa aa aaaa  aaaaaaaaaaaa a                                      aaaaaaaaaaaa  aaaa aa aa aa                               aa aaa aaa  aaaaaaaa aaa a                                      aaa aaaaaaaa  aaa aaa aa  a                               aaaaaa aaa  aaaaaaaaaaa  a                                       aaaaaaaaaaa  aaa aaaaaa  aa                              aaaaaaaaaaa aaaaaa aaa   a                                        aaa aaaaaa aaaaaaaaaaa   a                              aaaaaaaaaaa aa aaa aaa   a                                       aaaa aaa aa aaaaaaaaaaa                                   aaaaaaaaaaaaa aa aaaa   a                                       aaaaa aa aaaaaaaaaaaaaa                                   aaaaaaaaaaaaaaaa aaaa   a                                       aaaaa aaaaaaaaaaaaaaaaa                                   aaaaaaaaaaaaaaaa aaa    a                                       a aaa aaaaaaaaaaaaaaaaa                                   aaaaaaaaaaaaaaaaaaaa    a                                       a aaaaaaaaaaaaaaaaaaa a                                   a aaaaaaaaaaaaaaa aa   aa                                       a aa aaaaaaaaaaaaaaa  a                                   a aaaaaaaaaaaaaaaaa    a                                        a  aaaaaaaaaaaaaaaaa  a                                   a aaaaa aaaaaaaaaaa    a                                        a  aaaaaaaaaaa aaaaa  a                                   a  aa aaaaaaaaaaaaa    a                                        a  aaaaaaaaaaaaa aa   a                                   a  aaaaaaaaaaaaaaaa    a                                        a  aaaaaaaaaaaaaaaa   a                                   a  aaaaaaaaa aaaaaa    a                                       aa  aaaaaa aaaaaaaaa   a                                  aa  a aaaaaaa aaaaa     a                                      aa    aaaaa aaaaaaa a   a                                  a    aaaaaaaaaaaaaa    aa                                      a     aaaaaaaaaaaaaa    a                                       aaaaaaaaaaaaaa    a                                      aa     aaaaaaaaaaaaaa    a                                       aaaaaaa aaaaaa                                                  aaaaaa aaaaaaa    a                                       aaaaaaa aaaaaa                                                  aaaaaa aaaaaaa    aa                                      aaaaaaa aaaa a                                                  a aaaa aaaaaaa     aa                                      aaaaaa aaaa                                                      aaaa aaaaaa       a                                      aaaaaa aaaa                                                     aaaaa aaaaaa                                              aaaaaaaaaaa                                                     aaaaaaaaaaaa                                              aaaaaaaaaaa                                                     aaaaaaaaaaaa                                              aaaaaaaaaaa                                                     aaaaaaaaaaa                                               aaaaaa aaaa                                                    aaaaaa aaaaa                                               a aaaaaaaaa                                                    a aaaaaaaaa                                               aa aaaaaaaaa                                                   aa aaaaaaaaa                                               aa  aaaaaaaa                                                   a  aaaaaaaa                                                a   aaaaaaaa                                                   a  aaaaaaaa                                                a   a aaaaaa                                                   a  aaaaaa a                                                a   aaaaaaa                                                   a    aaaaaaa                                                a    aaaaaa                                                   a    aaaaaa                                                      aaaaaa                                                        aaaaaa                                                      a a aa                                                        aa a a                                                      a a  a                                                        a  a a                                                      a a  a                                                        a  a a                                                      a a                                                           a  a                             ",c:{a:[255,255,255,255]},s:[122,127]},flyeye:{data:"          aaaaa                aaaaa aaaa             aaaa aa   aaa          aaa       aaaaa       aaa aa      a  aaa     aaa              aaa    aa              aaaaa  aaaa               aaaa aa a                aaaaa                   aaaaaa                 aaaaa                     aaa                     aaa                     aaaa                    aaaa                    a  aa                  aa  aaa                 aa   aaaa             aaa    aaaa             aaa     aaaa a       a aaa       aaaaa       aaaa         aaaaaaaaaaaaaa             aaaaaaaaa       ",c:{a:[255,255,255,255]},s:[24,24]},player:{data:"                                           aa                                a                             aa                               aaa                           aaaa                              aaa                          aa  a                             aa aa                        aa   a                             aa aa                        a    a                             a   a     a                 aa    a   aa                       aa   a    aa                 a     aa   a                       aa    a   aa                 a      a   a                       a     a   aaa                a      aa  aa                     aa     aa  a aa               a       a  aa                     a      aaaaa  a               a       aaaa aa                  aa      aaaa   aa             aa        aa   aa                a a    a  aaa    aa            a     aa        aa              aa a    a   aa    aa            a     aa         aa             aaa     a         aa           aa     aa          aa           aaa     aa          a           a      aaa          a            a      aaa         a           a     aaaaa         aa         aaa     aaaaa        aa          a     aaaaaa         a         aa      aaaaaa        a          a     aaaaaaaa       a         aa      aaaaaaa       a          a     aaaaaaaaa      a         aa      aaaaaaa      aa          a     aaaaaaaaa     aa         a       aaaaaaa      aa          a     aaaaaaaaa     a          a       aaaaaaa      a           aa     aaaaaaaa     a          aa      aaaaaaa     aa            a     aaaaaaa     aa           a         aa      aa             aa     aaaaa      a            aa                aa              aa               a             aa              aa                aa             aa              aaa            aa                 aa           aa                 aaa      aaaa                    a       aaaa                     aaaaaaaaaa                     aaaaaaaaa                          aaaa                           aa                  ",c:{a:[255,200,0,255]},s:[64,32]}}},js13k.Audio={_cache:{},_muteVol:.2,SOUND:{NOISE:(a,e,t)=>(e[a]=2*Math.random()-1,t[a]=2*Math.random()-1,!1)},init(){this.ctx=new window.AudioContext,this.gain=this.ctx.createGain(),this.gain.connect(this.ctx.destination),this.volume(.1);for(const a in this.SOUND){const e=2*this.ctx.sampleRate,t=this.ctx.createBuffer(2,e,this.ctx.sampleRate),s=t.getChannelData(0),i=t.getChannelData(1);for(let t=0;t<e&&!this.SOUND[a](t,s,i);t++);this._cache[a]=t}},mute(){0!==this.gain.gain.value&&(this._muteVol=this.gain.gain.value,this.gain.gain.value=0)},play(a,e,t=1,s="dec"){const i=this.ctx.createGain();i.connect(this.gain),"inc"===s?(i.gain.setValueAtTime(0,this.ctx.currentTime),i.gain.linearRampToValueAtTime(t,this.ctx.currentTime+e-.01)):(i.gain.setValueAtTime(t,this.ctx.currentTime),i.gain.linearRampToValueAtTime(0,this.ctx.currentTime+e-.01));const r=this._cache[a.name],h=this.ctx.createBufferSource();return h.buffer=r,h.connect(i),h.start(0,0,e),h},playFreq(a,e,t="sine",s="dec"){const i=this.ctx.createGain();i.connect(this.gain),"inc"===s?(i.gain.setValueAtTime(0,this.ctx.currentTime),i.gain.linearRampToValueAtTime(1,this.ctx.currentTime+e-.01)):(i.gain.setValueAtTime(1,this.ctx.currentTime),i.gain.linearRampToValueAtTime(0,this.ctx.currentTime+e-.01));const r=this.ctx.createOscillator();return r.type=t,r.frequency.setValueAtTime(a,this.ctx.currentTime),r.connect(i),r.start(),r.stop(this.ctx.currentTime+e),r},unmute(){this.gain.gain.value=this._muteVol},volume(a){this.gain.gain.value=Math.min(1,Math.max(0,a))}},js13k.Input={ACTION:{PAUSE:1,DO:2,LEFT:10,UP:11,RIGHT:12,DOWN:13},_gpButtons:{},_ignoreUntilReleased:{},_on:{gp_connect:[],gp_disconnect:[]},_onKeyDown:{},_onKeyUp:{},gamepads:{},isLinuxFirefox:!1,keystate:{},numGamepads:0,buildActionKeyMap(){this.ACTION_KEY_MAP={[this.ACTION.PAUSE]:{keyboard:["Escape"],gamepad:[9]},[this.ACTION.UP]:{keyboard:["ArrowUp","KeyW","KeyZ","KeyY"],gamepad:[12]},[this.ACTION.LEFT]:{keyboard:["ArrowLeft","KeyA","KeyQ"],gamepad:[14]},[this.ACTION.DOWN]:{keyboard:["ArrowDown","KeyS"],gamepad:[13]},[this.ACTION.RIGHT]:{keyboard:["ArrowRight","KeyD"],gamepad:[15]},[this.ACTION.DO]:{keyboard:["Space","Enter"],gamepad:[0]}}},getDirections(){let a=0,e=0;if(this.isPressed(this.ACTION.LEFT)?a=-1:this.isPressed(this.ACTION.RIGHT)&&(a=1),this.isPressed(this.ACTION.UP)?e=-1:this.isPressed(this.ACTION.DOWN)&&(e=1),!a||!e){const t=.3;for(const s in this.gamepads){const i=this.gamepads[s];i.axes[0]&&Math.abs(i.axes[0])>t?a=i.axes[0]>0?1:-1:i.axes[2]&&Math.abs(i.axes[2])>t&&(a=i.axes[2]>0?1:-1),i.axes[1]&&Math.abs(i.axes[1])>t?e=i.axes[1]>0?1:-1:i.axes[3]&&Math.abs(i.axes[3])>t&&(e=i.axes[3]>0?1:-1)}}return{x:a,y:e}},getKeysForAction(a){return this.ACTION_KEY_MAP[a]},init(){const a=String(navigator.userAgent).toLowerCase();this.isLinuxFirefox=a.includes("linux")&&a.includes("firefox"),this.buildActionKeyMap(),this.registerEvents()},isPressed(a,e){const t=this.getKeysForAction(a);for(const a of t.keyboard)if(this.isPressedKey(a,e))return!0;for(const a of t.gamepad)if(this.isPressedGamepad(a,e))return!0;if(a===this.ACTION.LEFT)for(const a in this.gamepads){const t=this.gamepads[a];if(t.axes[6]&&t.axes[6]<=-.2)return!this._ignoreUntilReleased["axis6-"]&&(e&&(this._ignoreUntilReleased["axis6-"]=!0),!0)}else if(a===this.ACTION.RIGHT)for(const a in this.gamepads){const t=this.gamepads[a];if(t.axes[6]&&t.axes[6]>=.2)return!this._ignoreUntilReleased["axis6+"]&&(e&&(this._ignoreUntilReleased["axis6+"]=!0),!0)}else if(a===this.ACTION.UP)for(const a in this.gamepads){const t=this.gamepads[a];if(t.axes[7]&&t.axes[7]<=-.2)return!this._ignoreUntilReleased["axis7-"]&&(e&&(this._ignoreUntilReleased["axis7-"]=!0),!0)}else if(a===this.ACTION.DOWN)for(const a in this.gamepads){const t=this.gamepads[a];if(t.axes[7]&&t.axes[7]>=.2)return!this._ignoreUntilReleased["axis7+"]&&(e&&(this._ignoreUntilReleased["axis7+"]=!0),!0)}return!1},isPressedGamepad(a,e){for(const t in this.gamepads){const s=this.gamepads[t].buttons[a];if(s&&s.pressed)return!this._ignoreUntilReleased[a]&&(e&&(this._ignoreUntilReleased[a]=!0),!0)}return!1},isPressedKey(a,e){const t=this.keystate[a];return!(!t||!t.time)&&(e&&(t.time=0,t.waitForReset=!0),!0)},off(a,e){if("function"!=typeof e)return void(this._on[a]=[]);const t=this._on[a].indexOf(e);t>=0&&this._on[a].splice(t,1)},on(a,e){this._on[a].push(e)},onKeyDown(a,e){const t=this._onKeyDown[a]||[];t.push(e),this._onKeyDown[a]=t},onKeyUp(a,e){const t=this._onKeyUp[a]||[];t.push(e),this._onKeyUp[a]=t},registerEvents(){document.body.onkeydown=a=>{const e=this.keystate[a.code];e&&e.waitForReset||(this.keystate[a.code]={time:Date.now()},this._onKeyDown[a.code]&&this._onKeyDown[a.code].forEach((a=>a())))},document.body.onkeyup=a=>{this.keystate[a.code]={time:0},this._onKeyUp[a.code]&&this._onKeyUp[a.code].forEach((a=>a()))},window.addEventListener("gamepadconnected",(a=>{this.numGamepads++,this.gamepads[a.gamepad.index]=a.gamepad,this._on.gp_connect.forEach((a=>a()))})),window.addEventListener("gamepaddisconnected",(a=>{this.numGamepads--,delete this.gamepads[a.gamepad.index],this._on.gp_disconnect.forEach((a=>a()))}))},update(){const a=navigator.getGamepads();for(const e of a)if(e){this.gamepads[e.index]=e;for(const a in this._ignoreUntilReleased)"axis6-"===a||"axis6+"===a?e.axes[6]||delete this._ignoreUntilReleased[a]:"axis7-"===a||"axis7+"===a?e.axes[7]||delete this._ignoreUntilReleased[a]:e.buttons[a]&&!e.buttons[a].pressed&&delete this._ignoreUntilReleased[a]}}};{class a{constructor(){this.border=0,this.dangers=[],this.goProgress=0,this.isGameOver=!1,this.timer=0}checkHit(){if(!this.player||!this.player.vuln)return!1;const a=this.player.getHitbox(),e=js13k.Renderer.scale;this.ctxHit.clearRect(0,0,a[2],a[3]),this.ctxHit.drawImage(js13k.Renderer.cnvDanger,e*a[0],e*a[1],e*a[2],e*a[3],0,0,a[2],a[3]);const t=this.ctxHit.getImageData(0,0,a[2],a[3]);for(let a=0;a<t.data.length;a+=4){const e=t.data[a+0],s=t.data[a+1],i=t.data[a+2],r=t.data[a+3];if(e>=254&&s>=254&&i>=254&&r>=159)return!0;if(e>=59&&e<=61&&s>=118&&s<=120&&i>=146&&i<=148&&r>=254)return!0}return!1}draw(){this.isGameOver?this.drawGameOver(js13k.Renderer.ctx):(this.drawBackground(js13k.Renderer.ctx),this.drawBorder(js13k.Renderer.ctxDanger),this.dangers.forEach((a=>a.draw(js13k.Renderer.ctxDanger))),this.player&&(this.player.draw(js13k.Renderer.ctx),this.drawHP(js13k.Renderer.ctxUI)))}drawBackground(){}drawBorder(a){const e=Math.round(20+this.border),t=.5*e;return a.lineWidth=e,a.strokeStyle="#3C7793",a.strokeRect(t,t,js13k.Renderer.res-e,js13k.Renderer.res-e),e}drawGameOver(a){const e=js13k.Renderer.res,t=js13k.Renderer.center;a.font="bold 36px "+js13k.FONT,a.textAlign="center",a.fillStyle="#DDD",a.fillText("JUST GIVE UP!",t,t-138),a.fillText("LEAVE IT ALL TO ME.",t,t-102),a.fillStyle="#3C7793",a.fillText("JUST GIVE UP!",t,t-136),a.fillText("LEAVE IT ALL TO ME.",t,t-100),a.font="bold 18px "+js13k.FONT,a.fillStyle="#AAA",a.globalAlpha=js13k.getTextAlpha(this.timer),a.fillText("Or press [space] to try again",t,t-60),a.globalAlpha=1,this.goProgress<=1&&(a.fillStyle="#3C7793",a.fillRect(0,0,e,e*(1-Math.min(this.goProgress*this.goProgress,1))))}drawHP(a){const e=js13k.Renderer.center,t=js13k.Renderer.res;for(let s=0;s<3;s++)a.globalAlpha=this.player.hp>s?1:.3,a.drawImage(js13k.Player.sprite[0],e-60+40*s,t-42);a.globalAlpha=1}update(a){if(this.timer+=a,this.isGameOver)this.goProgress+=.015*a,js13k.Input.isPressed(js13k.Input.ACTION.DO,!0)&&js13k.Renderer.reloadLevel();else if(this.dangers.forEach((e=>e.update(a))),this.player){const e=js13k.Input.getDirections();this.player.update(a,e),this.player.hit<=this.timer&&this.checkHit()&&(this.player.hp--,js13k.Renderer.shake(),js13k.Audio.playFreq(29.14,.4,"sawtooth"),this.player.hp>0?this.player.hit=this.timer+240*a:this.isGameOver=!0)}}}js13k.Level=a}{class a{constructor(a,e){this.x=e.x||0,this.y=e.y||0,this.w=e.w||0,this.h=e.h||0,this._start=1/0,this.angle=0,this.canMove=!0,this.ended=0,this.level=a,this.sp=1}getCenter(a){let e=this.x+.5*this.w,t=this.y+.5*this.h;return a&&(e=Math.round(e),t=Math.round(t)),{x:e,y:t}}start(a=0){this._start=this.level.timer+a}}js13k.LevelObject=a}{class a extends js13k.LevelObject{constructor(e,t,s){super(e,{x:t,y:s,w:32,h:32}),this._attStart=0,this.attDur=100,this.canAttack=!1,this.hit=0,this.hp=3,this.r=0,this.rFull=55,this.sp=6,this.vuln=!0,a.sprite||(a.sprite=[a.preRender(this.w,this.h,0),a.preRender(this.w,this.h,this.w)])}attack(){this.onCooldown()||(this._attStart=this.level.timer,js13k.Audio.playFreq(146.83,.1))}draw(e){this.rFull===js13k.Renderer.res&&(e=js13k.Renderer.ctxUI);const t=this.getHitbox(),s=Math.round(t[0]+.5*t[2]),i=Math.round(t[1]+.5*t[3]),[r,h,n]=this.flicker?[.007,110,45]:[.01,120,55];if(e.fillStyle=`rgba(255,255,196,${r})`,e.beginPath(),e.ellipse(s,i,h,h,0,0,360),e.fill(),e.beginPath(),e.ellipse(s,i,n,n,0,0,360),e.fill(),this.canAttack){if(this.rFull,js13k.Renderer.res,e.fillStyle="#FFC800",e.lineWidth=1,e.strokeStyle="#FFC800",e.beginPath(),this.onCooldown()){const a=(this.level.timer-this._attStart)/this.attDur;this.r=this.rFull*Math.min(20*a,1),this.rFull!==js13k.Renderer.res&&(e.globalAlpha=1-Math.min(5*a,1)),e.ellipse(s,i,this.r,this.r,0,0,360),e.fill()}else e.globalAlpha=.3,e.ellipse(s,i,this.rFull,this.rFull,0,0,360),e.stroke();e.globalAlpha=1}if(this.hit-this.level.timer<=0||this.level.timer%30<15){const t=this.level.timer%20<10?0:1;e.drawImage(a.sprite[t],this.x,this.y)}}getCenter(a){const e=this.getHitbox();let t=e[0]+.5*e[2],s=e[1]+.5*e[3];return a&&(t=Math.round(t),s=Math.round(s)),{x:t,y:s}}getHitbox(){return[this.x+9,this.y+15,12,12]}isAttacking(){return this._attStart>0&&this.onCooldown()}onCooldown(){return this.level.timer-this._attStart<=20}update(a,e){this.isAttacking()||(this.x+=Math.round(a*e.x*this.sp),this.y+=Math.round(a*e.y*this.sp)),this.x=Math.min(js13k.Renderer.res-this.w,Math.max(0,this.x)),this.y=Math.min(js13k.Renderer.res-this.h,Math.max(0,this.y)),this.flicker>0?this.flicker-=a:this.flicker<0?this.flicker=0:Math.random()<.008&&(this.flicker=16*a)}}a.preRender=function(a,e,t){const[s,i]=js13k.Renderer.getOffscreenCanvas(a,e);return i.drawImage(js13k.Renderer.sprites.player,t,0,a,e,0,0,a,e),s},js13k.Player=a}js13k.Renderer={res:1e3,scale:1,sprites:{},clear(){const a=Math.ceil(this.cnv.width/this.scale);this.ctx.clearRect(0,0,a,a),this.ctxDanger.clearRect(0,0,a,a),this.ctxUI.clearRect(0,0,a,a)},draw(){this.clear(),this.level&&this.level.draw()},drawPause(){const a=Math.ceil(this.cnvUI.width/this.scale);this.ctxUI.setTransform(this.scale,0,0,this.scale,0,0),this.ctxUI.clearRect(0,0,a,a),this.ctxUI.fillStyle="rgba(0,0,0,0.4)",this.ctxUI.fillRect(0,0,a,a),this.ctxUI.fillStyle="#FFF",this.ctxUI.font="normal 56px "+js13k.FONT,this.ctxUI.textAlign="center",this.ctxUI.textBaseline="top",this.ctxUI.fillText("PAUSED",this.center,60)},getOffscreenCanvas(a,e){const t=document.createElement("canvas");t.width=a,t.height=e;const s=t.getContext("2d",{alpha:!0});return s.imageSmoothingEnabled=!1,[t,s]},init(a){this.cont=document.getElementById("m"),this.cnv=document.getElementById("c"),this.ctx=this.cnv.getContext("2d",{alpha:!0}),this.ctx.imageSmoothingEnabled=!1,this.cnvDanger=document.getElementById("d"),this.ctxDanger=this.cnvDanger.getContext("2d",{alpha:!0}),this.ctxDanger.imageSmoothingEnabled=!1,this.cnvUI=document.getElementById("ui"),this.ctxUI=this.cnvUI.getContext("2d",{alpha:!0}),this.ctxUI.imageSmoothingEnabled=!1,this.registerEvents(),this.loadSprites(a)},loadSprites(a){const e=js13k.Assets.sprites;e.vuln_ball={data:e.bg_eye_ball.data,c:{a:[223,68,13,255]},s:e.bg_eye_ball.s},e.vuln_blood={data:e.bg_eye_blood.data,c:{a:[223,68,13,255]},s:e.bg_eye_blood.s},e.vuln_iris={data:e.bg_eye_iris.data,c:{a:[223,68,13,255]},s:e.bg_eye_iris.s},e.w_tooth={data:e.br_tooth.data,c:{a:[255,255,255,255]},s:e.br_tooth.s},e.vuln_bite_small={data:e.bite_small.data,c:{a:[223,68,13,255]},s:e.bite_small.s};const t=Object.keys(e),s=i=>{if(i==t.length)return void a();const r=t[i],h=e[r],n=document.createElement("canvas");n.width=h.s[0],n.height=h.s[1];const l=n.getContext("2d",{alpha:!0}),o=l.createImageData(n.width,n.height);for(let a=0;a<h.data.length;a++){const e=h.data[a],t=h.c[e];let s=0,i=0,r=0,n=0;t&&([s,i,r,n]=t),o.data[4*a+0]=s,o.data[4*a+1]=i,o.data[4*a+2]=r,o.data[4*a+3]=n}l.putImageData(o,0,0),this.sprites[r]=n,setTimeout((()=>s(i+1)),1)};s(0)},mainLoop(a=0){if(js13k.Input.update(),a&&this.last){const e=(a-this.last)/(1e3/js13k.TARGET_FPS);if(this.ctx.imageSmoothingEnabled=!1,this.ctxDanger.imageSmoothingEnabled=!1,this.ctxUI.imageSmoothingEnabled=!1,this.ctx.lineWidth=1,this.ctx.textBaseline="alphabetic",this.ctx.setTransform(this.scale,0,0,this.scale,0,0),this.ctxDanger.setTransform(this.scale,0,0,this.scale,0,0),this.ctxUI.setTransform(this.scale,0,0,this.scale,0,0),this.isPaused)return void this.drawPause();this._shakeEnd&&(this._shakeEnd<=this.level.timer?(this._shakeEnd=0,this.cont.style.left=0,this.cont.style.top=0):(this.cont.style.left=Math.sin(this.level.timer)*this._shakeStr+"px",this.cont.style.top=Math.cos(this.level.timer)*this._shakeStr+"px")),this.level.update(e),this.draw(),js13k.DEBUG&&(this.ctxUI.fillStyle="#000",this.ctxUI.fillRect(30,this.res-45,160,28),this.ctxUI.fillStyle="#FFF",this.ctxUI.font="bold 16px "+js13k.FONT,this.ctxUI.textAlign="right",this.ctxUI.textBaseline="bottom",this.ctxUI.fillText(~~(js13k.TARGET_FPS/e)+" FPS / "+this.scale,180,this.res-22))}this.last=a,requestAnimationFrame((a=>this.mainLoop(a)))},pause(){this.isPaused=!0,js13k.Audio.mute()},registerEvents(){window.addEventListener("resize",(a=>this.resize())),this.resize();const a=js13k.Input.getKeysForAction(js13k.Input.ACTION.PAUSE);setInterval((()=>{this.isPaused&&js13k.Input.update(),a.gamepad.forEach((a=>{js13k.Input.isPressedGamepad(a,!0)&&this.togglePause()}))}),100);const e=()=>this.togglePause();a.keyboard.forEach((a=>js13k.Input.onKeyUp(a,e))),js13k.Input.on("gp_disconnect",(()=>this.pause()))},reloadLevel(){this.level=new this.level.constructor},resize(){const a=Math.min(window.innerWidth,window.innerHeight);this.cnv.height=a,this.cnv.width=a,this.cnvDanger.height=a,this.cnvDanger.width=a,this.cnvUI.height=a,this.cnvUI.width=a,this.center=Math.round(this.res/2),this.scale=a/this.res,this.isPaused&&(clearTimeout(this._timeoutDrawPause),this._timeoutDrawPause=setTimeout((()=>this.drawPause()),100))},shake(a=10,e=3){this._shakeEnd=this.level.timer+a,this._shakeStr=e},togglePause(){this.isPaused?this.unpause():this.pause()},unpause(){this.isPaused&&(this.isPaused=!1,js13k.Audio.unmute(),this.mainLoop())}};{class a extends js13k.LevelObject{constructor(a){super(a,{w:300,h:80}),this.progress=-7}draw(a){if(!this.show)return;const e=6*this.h,t=10*(Math.sin(this.level.timer/20)+1);let s=Math.round(this.progress*this.h);this.progress>0&&(s%=e);let i=this.x-t,r=this.y-e+s-this.h;a.drawImage(js13k.Renderer.sprites.w_tooth,i,r+=e,this.w,this.h),a.drawImage(js13k.Renderer.sprites.w_tooth,i,r+=e,this.w,this.h),i=js13k.Renderer.res-20-this.level.border+t,r=this.y-e+s-this.h,a.translate(i,r),a.scale(-1,1),a.translate(-i,-r),r-=.5*e,a.drawImage(js13k.Renderer.sprites.w_tooth,i,r+=e,this.w,this.h),a.drawImage(js13k.Renderer.sprites.w_tooth,i,r+=e,this.w,this.h),a.setTransform(js13k.Renderer.scale,0,0,js13k.Renderer.scale,0,0)}update(a){this.show&&(this.x=this.level.border+20,this.y=this.level.border+20,this.progress+=.03*a)}}js13k.LevelObject.FangBoss=a}{class a extends js13k.LevelObject{constructor(e,t,s,i=0,r=1.5){super(e,{x:t,y:s,w:a.W,h:a.H}),this.moveX=i,this.moveY=r;const h=js13k.Renderer.center;(this.x<h&&this.moveX<0||this.x>h&&this.moveX>0)&&(this.moveX*=-1)}draw(a){if(this.ended||this._start>this.level.timer)return;if(!this.isInDrawArea())return;a.drawImage(js13k.Renderer.sprites.flyeye,Math.round(this.x-.5*this.w),Math.round(this.y-.5*this.h));const e=3*Math.sin(this.level.timer/25),t=Math.round(this.x+e),s=Math.round(this.y);a.lineCap="round",a.lineWidth=2,a.strokeStyle="#FFF",a.beginPath(),a.moveTo(t,s-2),a.lineTo(t,s+6),a.stroke()}isInDrawArea(){const a=js13k.Renderer.res,e=.5*this.w,t=.5*this.h;return this.x<a&&this.x+e>0&&this.y<a&&this.y+t>0}update(a){this.ended||this._start>this.level.timer||this.canMove&&(this.x+=this.moveX*a,this.y+=this.moveY*a)}}a.W=24,a.H=24,js13k.LevelObject.FlyEye=a}{class a extends js13k.LevelObject{constructor(e,t,s,i=0,r=0){super(e,{x:t,y:s,w:a.W,h:a.H}),this.angleTarget=0,this.attackStart=0,this.attackEnd=1,this.sp=4,this.targetX=i,this.targetY=r,a.sprite||(a.sprite=[a.preRender(this.w,this.h,0),a.preRender(this.w,this.h,this.w)])}draw(e){const t=this.level.timer%20<10?0:1,s=this.getCenter(!0);if(e.translate(s.x,s.y),e.rotate(this.angle),e.translate(-s.x,-s.y),e.drawImage(a.sprite[t],Math.round(this.x),Math.round(this.y)),this.attackStarted&&!this.ended){const a=Math.min((this.level.timer-this._start)/100,1),t=a*a,s=this.x+.5*this.w;e.fillStyle=`rgba(255,255,255,${t})`,e.strokeStyle=`rgba(255,255,255,${t})`,e.lineWidth=Math.round(a*a*30),e.lineCap="round",e.beginPath(),e.moveTo(s,this.y),e.lineTo(s,this.y-.7*js13k.Renderer.res),e.stroke();const i=1.1*e.lineWidth;e.beginPath(),e.ellipse(s,this.y-.7*js13k.Renderer.res,i,i,0,0,360),e.fill(),this._sound||(this._sound=js13k.Audio.play(js13k.Audio.SOUND.NOISE,.4,.3))}e.setTransform(js13k.Renderer.scale,0,0,js13k.Renderer.scale,0,0)}getMoveToTarget(a,e,t){const s=this.getCenter(),i=s.x-e,r=s.y-t;let h=0,n=0;return i>0?h-=a*this.sp:i<0&&(h+=a*this.sp),r>0?n-=a*this.sp:r<0&&(n+=a*this.sp),[h,n,i,r]}update(a){if(this._start>this.level.timer)return;if(1===this.attackEnd&&this.attackStarted){if(this.ended=this.level.timer-this._start>180,this.ended&&this.canMove&&this.endTargetX){const[e,t]=this.getMoveToTarget(a,this.endTargetX,this.endTargetY);this.targetX!==this.endTargetX&&(this.x+=e),this.targetY!==this.endTargetY&&(this.y+=t)}return}0===this.attackStart&&(this.attackStarted=this.level.timer-this._start>30);const e=this.getCenter();if(this.canMove)if(this.attackStarted){if(this.endTargetX){const[e,t]=this.getMoveToTarget(a,this.endTargetX,this.endTargetY);this.x+=e,this.y+=t}}else{const[e,t,s,i]=this.getMoveToTarget(a,this.targetX,this.targetY);if(1===this.attackStart&&Math.abs(s)<2&&Math.abs(i)<2)return void(this.attackStarted=!0);this.x+=e,this.y+=t}if(1===this.angleTarget){const a=this.level.player.getCenter(),[t,s]=js13k.normalize([a.x-e.x,a.y-e.y]);s>4&&(this.angle=Math.atan2(t[1],t[0])+1.5707963267948966)}else if(2===this.angleTarget){const[a,t]=js13k.normalize([this.targetX-e.x,this.targetY-e.y]);t>4&&(this.angle=Math.atan2(a[1],a[0])+1.5707963267948966)}}}a.W=61,a.H=127,a.preRender=function(a,e,t){const[s,i]=js13k.Renderer.getOffscreenCanvas(a,e);return i.drawImage(js13k.Renderer.sprites.eye,t,0,a,e,0,0,a,e),s},js13k.LevelObject.LaserEye=a}{class a extends js13k.LevelObject{constructor(e){super(e,{w:64,h:32}),this.mode=0,this.cooldown=30,this.show=!0,this._tEnd=-1,a.sprite||(a.sprite=[a.preRender(this.w,this.h,0,0),a.preRender(this.w,this.h,1,0),a.preRender(this.w,this.h,0,1),a.preRender(this.w,this.h,1,1)])}attack(a,e=0){this.canAttack()&&(this.dir=e,this._sound=null,this._t=a,this._tEnd=this.level.timer+100,this.x=this._t.x-.5*this.w,this.y=this._t.y-.5*this.h,this.progress=-.7)}canAttack(){return!this._t&&this.level.timer-this._tEnd>=this.cooldown}draw(e){if(!this._t||this.wasHit)return;const t=Math.max(this.progress,0),s=100*(1-t*t*t*t),i=js13k.Renderer.scale,r=this.x+.5*this.w,h=this.y;0===this.dir?e.setTransform(1.5*i,0,0,1.5*i,r*i*-.5,h*i*-.5):1===this.dir?(e.translate(r,h),e.scale(1.5,1.5),e.rotate(.5*Math.PI),e.translate(-r,-h)):2===this.dir?(e.translate(r,h),e.scale(1.5,1.5),e.rotate(.25*Math.PI),e.translate(-r,-h)):3===this.dir&&(e.translate(r,h),e.scale(1.5,1.5),e.rotate(.75*Math.PI),e.translate(-r,-h));const n=this.mode&&t>=1?2:0;e.drawImage(a.sprite[0+n],this.x,this.y-s),e.drawImage(a.sprite[1+n],this.x,this.y+s),e.setTransform(i,0,0,i,0,0)}isVulnerable(){return this.mode&&this._t&&!this.wasHit&&this.progress>=1}update(a){this._t&&(!this._sound&&this._tEnd<this.level.timer+65&&(this._sound=js13k.Audio.playFreq(65.41,.1)),this._tEnd<this.level.timer?this._t=null:this.progress=Math.min(this.progress+.05*a,1))}}a.preRender=function(a,e,t,s){const[i,r]=js13k.Renderer.getOffscreenCanvas(a,e),[h,n]=1===t?[-1,e]:[1,0],l=s?"vuln_bite_small":"bite_small";return r.setTransform(-1,0,0,h,a/2,n),r.drawImage(js13k.Renderer.sprites[l],0,0,a/2,e,0,0,a/2,e),r.setTransform(1,0,0,h,0,n),r.drawImage(js13k.Renderer.sprites[l],0,0,a/2,e,a/2,0,a/2,e),r.setTransform(1,0,0,1,0,0),i},js13k.LevelObject.SmallBite=a}{class a extends js13k.LevelObject{constructor(e,t,s){super(e,{x:t,y:s,w:a.W,h:a.H}),this.x-=.5*this.w,this.y-=.5*this.h,this.show=!1,this._tEnd=-1}attack(a){!this.show||this.ended||this._t||this.isVulnerable()||(this._t=a,this._tEnd=this.level.timer+200)}draw(a){if(!this.show||this.ended)return;a.globalAlpha=this._t||this.isVulnerable()?1:.4;let e=this.x,t=this.y;const s=js13k.Renderer.sprites,i=this.isVulnerable()?s.vuln_ball:s.bg_eye_ball,r=this.isVulnerable()?s.vuln_blood:s.bg_eye_blood,h=this.isVulnerable()?s.vuln_iris:s.bg_eye_iris;a.drawImage(i,e,t),a.drawImage(r,e,t);let n=null;n=this._t?{x:this._t.x+.5*this._t.w,y:this._t.y+.5*this._t.h}:this.level.player.getCenter();const[l,o]=js13k.normalize([e-n.x,t-n.y]);if(e+=.5*this.w-10+12*Math.sin(-l[0]),t+=.5*this.h-25+9*Math.sin(-l[1]),a.drawImage(h,e,t),a.globalAlpha=1,this._t&&this._tEnd-160<this.level.timer){e+=10,t+=25,a.lineCap="round",a.lineWidth=20,a.fillStyle="#FFF",a.strokeStyle="#FFF";const[s,i]=js13k.normalize([n.x-e,n.y-t]);a.beginPath(),a.moveTo(e,t),a.lineTo(e+1e3*s[0],t+1e3*s[1]),a.stroke(),this._sound||(this._sound=js13k.Audio.play(js13k.Audio.SOUND.NOISE,.3,.5))}}isVulnerable(){return this._tEnd>0&&this._tEnd<=this.level.timer&&this._tEnd+200>=this.level.timer}update(a){this._tEnd<=this.level.timer&&(this._t=null,this._sound=null)}}a.W=89,a.H=90,js13k.LevelObject.TurretEye=a}{class a extends js13k.Level{constructor(){super(),this.border=-18,this.phase=0,this.player=new js13k.Player(this),this.progress=0,this.texts=["WANTED TO SLEEP?\nOH, SORRY ABOUT THAT.","I'M YOUR FEARS.\nBIG FAN OF YOURS.","YOUR MENTAL SPACE LOOKED\nKIND OF COZY LATELY.","DON'T MIND ME.","WHAT, YOU DO MIND ME?!","THEN IT'S ON!"]}draw(){const a=js13k.Renderer.ctx,e=js13k.Renderer.res,t=js13k.Renderer.center;this.drawBackground(a),this.drawBorder(a),this.player.draw(a);const s=.01*this.timer,i=1-Math.min(s*s,1);if(i>0)return a.fillStyle=`rgba(0,0,0,${i})`,void a.fillRect(0,0,e,e);if(this.text){a.textAlign="center",a.font="bold 36px "+js13k.FONT;const e=this.text.split("\n");let s=t-104-36*e.length;e.forEach((e=>{a.fillStyle="#DDD",a.fillText(e,t,s-2),a.fillStyle="#3C7793",a.fillText(e,t,s),s+=36})),a.fillStyle="#AAA",a.font="bold 18px "+js13k.FONT,a.globalAlpha=js13k.getTextAlpha(this.timer),a.fillText("Press [space] to continue",t,t-90),a.globalAlpha=1,a.fillStyle="#FFC800",1===this.phase||2===this.phase?a.fillText("<- you",t+60,t+10):4===this.phase&&a.fillText("!",t+14,t-4)}if(this.phase>=this.texts.length&&(a.fillStyle="#3C7793",a.fillRect(0,0,e,e*Math.min(this.progress*this.progress,1)),this.progress>=1&&this.progress<=4)){const e=(this.progress-1)/3;a.font="bold 64px "+js13k.FONT,a.fillStyle="#000",a.globalAlpha=1-e,a.fillText("NESTLING FEARS",t,t-32),a.globalAlpha=1}}drawBackground(a){a.globalAlpha=.3;const e=js13k.Renderer.sprites,t=js13k.Renderer.center;let s=t-45,i=t-45-290;a.drawImage(e.bg_eye_ball,s,i),this.isBlinking?(a.lineWidth=2,a.strokeStyle="#FFF",a.beginPath(),a.moveTo(t-40,t+2-290),a.lineTo(t+40,t+2-290),a.stroke()):(a.drawImage(e.bg_eye_blood,s,i),s=t-10,i=t-12-290,1!==this.phase&&4!==this.phase||(i-=10),a.drawImage(e.bg_eye_iris,s,i)),a.globalAlpha=1}update(a){this.timer+=a,this.isBlinking=(this.timer+100)%400<5,this.player.x=js13k.Renderer.center-.5*this.player.w,this.player.y=js13k.Renderer.center-.5*this.player.h,.01*this.timer>=1&&this.phase<this.texts.length?(this.border=Math.min(this.border+.02*a,0),js13k.Input.isPressed(js13k.Input.ACTION.DO,!0)&&this.phase++,this.text=this.texts[this.phase]||null):this.phase>=this.texts.length&&(this.progress+=.015*a,this.progress>4&&(js13k.Renderer.level=new js13k.Level.Eyes))}}js13k.Level.Intro=a}{class a extends js13k.Level{constructor(){super(),this.progress=0,this._won=!1;const a=js13k.Renderer.res,e=js13k.Renderer.center;this.player=new js13k.Player(this),this.player.x=.5*(a-this.player.w),this.player.y=.5*(a-this.player.h);const t=js13k.LevelObject.FlyEye,s=js13k.LevelObject.LaserEye,i=js13k.LevelObject.TurretEye;this.phase1=[];for(let e=0;e<15;e++){const t=e%2,i=t?-s.H:a+.5*s.H,r=Math.round(e*s.W),h=new s(this,i,r,t?20:a-20,r+Math.round(.5*s.H));h.angle=t?.5*Math.PI:1.5*Math.PI,h.endTargetX=t?a+100:-100,h.endTargetY=h.targetY,this.phase1.push(h)}const r=new s(this,0,e-.5*s.H,e+30,e);r.angle=.5*Math.PI;const h=new s(this,e-.5*s.W,0,e,e+30);h.angle=Math.PI;const n=new s(this,a,e-.5*s.H,e-30,e);n.angle=1.5*Math.PI;const l=new s(this,e-.5*s.W,a,e,e-30);this.phase2=[r,h,n,l],this.phase2.forEach((a=>{a.attackEnd=0,a.attackStart=1}));const o=()=>200+Math.random()*(a-400),d=()=>.7*(2*Math.random()-1);let c=-32;this.phase2.push(new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d()),new t(this,o(),c,d())),this.phase3=[new i(this,e-180,e-180),new i(this,e+180,e-180),new i(this,e+180,e+180),new i(this,e-180,e+180)],[this.cnvHit,this.ctxHit]=js13k.Renderer.getOffscreenCanvas(this.player.w,this.player.h);const[g,p]=js13k.Renderer.getOffscreenCanvas(48,js13k.Renderer.res+192);for(this._cnvBorder=g,c=0;c<js13k.Renderer.res;)p.drawImage(js13k.Renderer.sprites.br_eye,0,c,32,64),c+=64,p.drawImage(js13k.Renderer.sprites.br_eye,0,c,16,32),c+=32,p.drawImage(js13k.Renderer.sprites.br_eye,0,c,48,96),c+=96}draw(){if(super.draw(),this.isGameOver)return;const a=js13k.Renderer.res,e=js13k.Renderer.center,t=js13k.Renderer.ctx;t.font="bold 20px "+js13k.FONT,t.fillStyle="#AAA",t.textAlign="center",this.phase?5===this.phase&&(t.fillText("You now have an       . Use it with        .",e,e-130),t.fillText("Wait for the       to become           .",e,e-100),t.globalAlpha=js13k.getTextAlpha(this.timer),t.fillText("Press [space] to continue",e,e-60),t.globalAlpha=1,t.fillStyle="#FFC800",t.fillText("                attack              [space] ",e,e-130),t.fillStyle="#FFF",t.fillText("             enemy                      ",e,e-100),t.fillStyle="#DF440D",t.fillText("                             vulnerable ",e,e-100)):(t.fillText("Do not touch            or        .",e,e-100),t.globalAlpha=js13k.getTextAlpha(this.timer),t.fillText("Press [space] to continue",e,e-60),t.globalAlpha=1,t.fillStyle="#3C7793",t.fillText("             the border            ",e,e-100),t.fillStyle="#FFF",t.fillText("                           enemies ",e,e-100),t.fillStyle="#FFC800",t.fillText("Your hit points",e,a-80),t.fillText("v",e,a-60)),this.phase||(t.fillStyle="#3C7793",t.fillRect(0,0,a,a*(1-Math.min(this.progress*this.progress,1))))}drawBackground(a){const e=js13k.Renderer.sprites;let t=e.bg_eye_ball,s=e.bg_eye_blood,i=e.bg_eye_iris;6!==this.phase||this._won?6===this.phase&&this._won?(a.globalAlpha=1,t=e.vuln_ball,s=e.vuln_blood,i=e.vuln_iris):a.globalAlpha=.1:(a=js13k.Renderer.ctxDanger).globalAlpha=this._alpha;const r=js13k.Renderer.center,h=js13k.Renderer.scale;let n=r-90,l=r-90;a.setTransform(2*h,0,0,2*h,-n*h,-l*h),a.drawImage(t,n,l),a.drawImage(s,n,l);const o=this.player.getCenter(),[d,c]=js13k.normalize([r-o.x,r-o.y]);n=r-15+24*Math.sin(-d[0]),l=r-50+14*Math.sin(-d[1]),a.setTransform(2*h,0,0,2*h,-n*h,-l*h),a.drawImage(i,n,l),a.setTransform(h,0,0,h,0,0),a.globalAlpha=1}drawBorder(a){const e=super.drawBorder(a),t=Math.round(e+4*Math.sin(this.timer/20))-4.2,s=js13k.Renderer.scale;a.drawImage(this._cnvBorder,t,-96);let i=js13k.Renderer.res-t;a.setTransform(-s,0,0,s,2*s*i,0),a.drawImage(this._cnvBorder,js13k.Renderer.res-t,0);let r=Math.sin(.5*-Math.PI),h=Math.cos(.5*-Math.PI);i=e;let n=js13k.Renderer.res-t;return a.setTransform(s*h,s*r,-s*r,s*h,s*(i+n*r-i*h),s*(n-n*h-i*r)),a.drawImage(this._cnvBorder,i,n),r=Math.sin(.5*Math.PI),h=Math.cos(.5*Math.PI),i=js13k.Renderer.res-e,n=t,a.setTransform(s*h,s*r,-s*r,s*h,s*(i+n*r-i*h),s*(n-n*h-i*r)),a.drawImage(this._cnvBorder,js13k.Renderer.res-e,t),a.setTransform(s,0,0,s,0,0),e}update(a){if(super.update(a),this.phase)if(1===this.phase)this.dangers=this.phase1,this.dangers.forEach(((a,e)=>a.start(33*e))),this.phase=2,this._end=this.timer+33*this.dangers.length+500;else if(2===this.phase&&this.timer>this._end)this.dangers=[],this.phase=3;else if(3===this.phase)this.dangers=this.phase2,this.dangers.forEach(((a,e)=>{e<4?a.start():a.start(20+45*e)})),this.phase=4,this._end=this.timer+1800;else if(4===this.phase&&this.timer>this._end-1600&&this.timer<=this._end){const e=js13k.LevelObject.LaserEye,t=js13k.Renderer.center,s=[[.5*-e.W,.5*-e.W],[0,.5*-e.H],[.5*e.W,.5*-e.W],[0,0]];let i=this.timer>this._end-700?-.015:.015;if(this._end-this.timer<710&&this._end-this.timer>680&&(i=0),this.timer>this._end-300){const a=(this.dangers[0].angle+2*Math.PI)%(2*Math.PI);if(Math.abs(a-.5*Math.PI)<.01&&!this.dangers[0].canMove){this.dangers.forEach((a=>{a.ended=!0,a.canMove=!0}));const a=js13k.Renderer.res;this.dangers[0].x=this.dangers[0].targetX-.5*e.W,this.dangers[0].y=this.dangers[0].targetY-.5*e.H,this.dangers[0].angle=.5*Math.PI,this.dangers[0].endTargetX=a+100,this.dangers[0].endTargetY=t,this.dangers[0].targetY=t,this.dangers[1].x=this.dangers[1].targetX-.5*e.W,this.dangers[1].y=this.dangers[1].targetY-.5*e.H,this.dangers[1].angle=Math.PI,this.dangers[1].endTargetX=t,this.dangers[1].endTargetY=a+100,this.dangers[1].targetX=t,this.dangers[2].x=this.dangers[2].targetX-.5*e.W,this.dangers[2].y=this.dangers[2].targetY-.5*e.H,this.dangers[2].angle=1.5*Math.PI,this.dangers[2].endTargetX=-100,this.dangers[2].endTargetY=t,this.dangers[2].targetY=t,this.dangers[3].x=this.dangers[3].targetX-.5*e.W,this.dangers[3].y=this.dangers[3].targetY-.5*e.H,this.dangers[3].angle=0,this.dangers[3].endTargetX=t,this.dangers[3].endTargetY=-100,this.dangers[3].targetX=t}}this.dangers.forEach(((r,h)=>{if(h<4&&!r.ended){r.canMove&&(r._c=r.getCenter()),r.attackStarted=!0,r.canMove=!1,r.angle=(r.angle+a*i)%(2*Math.PI);const n=Math.cos(r.angle),l=Math.sin(r.angle),o={x:r._c.x+s[h][0],y:r._c.y+s[h][1]},d=o.x*n-o.y*l+t*(1+l-n),c=o.x*l+o.y*n+t*(1-l-n);r.x=d-.5*e.W,r.y=c-.5*e.H}}))}else if(4===this.phase&&this.timer>this._end)this.dangers=[],this.phase=5;else if(5===this.phase)js13k.Input.isPressed(js13k.Input.ACTION.DO,!0)&&(this.dangers=this.phase3,this.phase=6,this.player.canAttack=!0,this._alpha=.1,this._start=this.timer,js13k.Renderer.shake(200,1));else if(6!==this.phase||this._won)6===this.phase&&this._won?(this.dangers=[],this.player.canAttack=!0,js13k.Input.isPressed(js13k.Input.ACTION.DO,!0)&&(this.player.vuln=!1,this.player.attDur=800,this.player.rFull=js13k.Renderer.res,this.player.attack(),this.player.onCooldown=()=>!0,this.phase=7,this._end=this.timer+200)):7===this.phase&&this._end<this.timer&&(js13k.Renderer.level=new js13k.Level.Teeth(this.player.hp));else if(js13k.Input.isPressed(js13k.Input.ACTION.DO,!0)&&this.player.attack(),this.timer-this._start<200)this._alpha=Math.max(Math.min((this.timer-this._start)/200,1),.1),this._start2=this.timer;else{if(this.dangers[0].show=!0,this.player.isAttacking()){const a=this.player.getCenter();a.r=.9*this.player.r;for(let e=0;e<this.dangers.length;e++){const t=this.dangers[e],s=t.getCenter();if(s.r=.5*t.w,t.show&&!t.ended&&t.isVulnerable()&&js13k.circleOverlap(a,s)){t.ended=this.timer,this._start2=this.timer,js13k.Renderer.shake(10,2),e===this.dangers.length-1?this._won=!0:this.dangers[e+1].show=!0;break}}}const a=this.player.getHitbox(),e={x:a[0],y:a[1],w:a[2],h:a[3]};this.timer-this._start2>100&&this.dangers.forEach((a=>{a.attack(e)}))}else this.progress+=.015*a,this.progress>1&&js13k.Input.isPressed(js13k.Input.ACTION.DO,!0)&&(this.phase=1);switch(this.phase){case 2:this.border+=.2*a,this.border=Math.min(this.border,80);break;case 4:case 6:this.border+=.2*a,this.border=Math.min(this.border,200)}}}js13k.Level.Eyes=a}{class a extends js13k.Level{constructor(a){super(),this._start=0,this._end=1/0,this.bossHits=0,this.progress=0;const e=js13k.Renderer.res;this.player=new js13k.Player(this),this.player.hp=a||this.player.hp,this.player.x=.5*(e-this.player.w),this.player.y=.5*(e-this.player.h),this.phase1=[new js13k.LevelObject.SmallBite(this),new js13k.LevelObject.FangBoss(this)],[this.cnvHit,this.ctxHit]=js13k.Renderer.getOffscreenCanvas(this.player.w,this.player.h);const[t,s]=js13k.Renderer.getOffscreenCanvas(90,e+114);this._cnvBorder=t;let i=0;for(;i<e;)s.drawImage(js13k.Renderer.sprites.br_tooth,0,i,60,32),i+=38,s.drawImage(js13k.Renderer.sprites.br_tooth,0,i,30,16),i+=22,s.drawImage(js13k.Renderer.sprites.br_tooth,0,i,90,48),i+=54}draw(){if(this.isGameOver)return void this.drawGameOver(js13k.Renderer.ctx);this.drawBackground(js13k.Renderer.ctx),this.dangers.forEach((a=>a.draw(js13k.Renderer.ctxDanger))),this.drawBorder(js13k.Renderer.ctxDanger),this.player&&(this.player.draw(js13k.Renderer.ctx),this.drawHP(js13k.Renderer.ctxUI));const a=js13k.Renderer.res,e=js13k.Renderer.center,t=js13k.Renderer.ctx;t.font="bold 18px "+js13k.FONT,t.fillStyle="#AAA",t.textAlign="center",this.phase?2===this.phase&&this._end<=this.timer&&(t.fillText("It is again time to       .",e,e-130),t.fillText("Wait for the       to become           .",e,e-100),t.globalAlpha=js13k.getTextAlpha(this.timer),t.fillText("Press [space] to continue",e,e-60),t.globalAlpha=1,t.fillStyle="#FFC800",t.fillText("                    attack ",e,e-130),t.fillStyle="#FFF",t.fillText("             enemy                      ",e,e-100),t.fillStyle="#DF440D",t.fillText("                             vulnerable ",e,e-100)):(t.globalAlpha=js13k.getTextAlpha(this.timer),t.fillText("Press [space] to continue",e,e-60),t.globalAlpha=1,t.font="bold 36px "+js13k.FONT,t.fillText("NOT ENOUGH!",e,e-138),t.fillText("COME ON, LET ME DEVOUR YOU.",e,e-102),t.fillStyle="#3C7793",t.fillText("NOT ENOUGH!",e,e-136),t.fillText("COME ON, LET ME DEVOUR YOU.",e,e-100),js13k.Renderer.ctxUI.fillStyle="#FFC800",js13k.Renderer.ctxUI.fillRect(0,a*Math.min(this.progress*this.progress,1),a,a))}drawBorder(a){const e=super.drawBorder(a),t=Math.round(e+2*Math.sin(this.timer/20))-2.5,s=js13k.Renderer.scale;let i=js13k.Renderer.res-t;a.drawImage(this._cnvBorder,t,-48),a.setTransform(-s,0,0,s,2*s*i,0),a.drawImage(this._cnvBorder,js13k.Renderer.res-t,0);let r=Math.sin(.5*-Math.PI),h=Math.cos(.5*-Math.PI);i=e;let n=js13k.Renderer.res-t;return a.setTransform(s*h,s*r,-s*r,s*h,s*(i+n*r-i*h),s*(n-n*h-i*r)),a.drawImage(this._cnvBorder,i,n),r=Math.sin(.5*Math.PI),h=Math.cos(.5*Math.PI),i=js13k.Renderer.res-e,n=t,a.setTransform(s*h,s*r,-s*r,s*h,s*(i+n*r-i*h),s*(n-n*h-i*r)),a.drawImage(this._cnvBorder,js13k.Renderer.res-e,t),a.setTransform(s,0,0,s,0,0),e}update(a){if(super.update(a),this.phase)if(1===this.phase&&this._start+100<this.timer)this.phase=2,this._end=this.timer+1e3;else if(2===this.phase&&this._end>this.timer){if(this.dangers[0].canAttack()){const a=this.player.getCenter(),e=js13k.shuffle([0,1,2,3]);this.dangers[0].attack(a,e[0])}}else if(2===this.phase)js13k.Input.isPressed(js13k.Input.ACTION.DO,!0)&&(this.phase=3,this._start=this.timer,this.player.canAttack=!0,this.dangers[0].cooldown=200,this.dangers[0].mode=1,this.dangers[1].show=!0);else if(3===this.phase){if(js13k.Input.isPressed(js13k.Input.ACTION.DO,!0)&&this.player.attack(),this.player.isAttacking()){const a=this.player.getCenter();a.r=this.player.r;const e=this.dangers[0],t=e.getCenter();t.r=.5*e.w,e.isVulnerable()&&js13k.circleOverlap(a,t)&&(e.wasHit=!0,this.bossHits++,js13k.Renderer.shake(10,2),this.bossHits>=4&&(this.phase=4,this._end=this.timer+300))}if(3===this.phase&&this.dangers[0].canAttack()&&this._start+140<this.timer){this.dangers[0].wasHit=!1;const a=this.player.getCenter();this.dangers[0].attack(a,0)}}else 4===this.phase&&this._end>this.timer?(this.dangers=[],this.player.vuln=!1,this.player.attDur=800,this.player.rFull=js13k.Renderer.res,this.player.attack(),this.player.onCooldown=()=>!0):4===this.phase&&(js13k.Renderer.level=new js13k.Level.Outro);else this.progress+=.015*a,this.progress>1&&js13k.Input.isPressed(js13k.Input.ACTION.DO,!0)&&(this.phase=1,this.dangers=this.phase1,this._start=this.timer);switch(this.phase){case 1:case 2:this.border+=.15*a,this.border=Math.min(this.border,120);break;case 3:case 4:this.border+=.2*a,this.border=Math.max(Math.min(this.border,220),120)}}}js13k.Level.Teeth=a}{class a extends js13k.Level{constructor(){super(),this.border=360,this.progress=0,this.progressBorder=0;const a=js13k.Renderer.res,[e,t]=js13k.Renderer.getOffscreenCanvas(90,a+114);this._cnvBorder=e;let s=0;for(;s<a;)t.drawImage(js13k.Renderer.sprites.br_tooth,0,s,60,32),s+=38,t.drawImage(js13k.Renderer.sprites.br_tooth,0,s,30,16),s+=22,t.drawImage(js13k.Renderer.sprites.br_tooth,0,s,90,48),s+=54}draw(){super.draw();const a=js13k.Renderer.center,e=js13k.Renderer.res,t=js13k.Renderer.ctx;t.font="bold 28px "+js13k.FONT,t.textAlign="center",t.fillStyle="#DDD",t.fillText("WELL, YOU WON TODAY.",a,a-180),t.fillText("THE HEADSPACE IS ALL YOURS.",a,a-140),t.fillText("SLEEP TIGHT THEN...",a,a-100),t.font="bold 20px "+js13k.FONT,t.fillStyle="#AAA",t.fillText("AND SEE YOU AGAIN.",a,e-50),this.progress<=1&&(js13k.Renderer.ctxUI.fillStyle="#FFC800",js13k.Renderer.ctxUI.fillRect(0,0,e,e*(1-Math.min(this.progress*this.progress,1))))}drawBackground(a){a.globalAlpha=.3;const e=js13k.Renderer.sprites,t=js13k.Renderer.center;let s=t-45,i=t-45;a.drawImage(e.bg_eye_ball,s,i),this.isBlinking?(a.lineWidth=2,a.strokeStyle="#FFF",a.beginPath(),a.moveTo(t-40,t+2),a.lineTo(t+40,t+2),a.stroke()):(a.drawImage(e.bg_eye_blood,s,i),s=t-10,i=t-25,a.drawImage(e.bg_eye_iris,s,i)),a.globalAlpha=1}drawBorder(a){const e=js13k.Renderer.res,t=js13k.Renderer.scale,s=super.drawBorder(a),i=Math.round(s+2*Math.sin(this.timer/20))-2.5-50*this.progressBorder;let r=e-i;a.drawImage(this._cnvBorder,i,-48),a.setTransform(-t,0,0,t,2*t*r,0),a.drawImage(this._cnvBorder,e-i,0);let h=Math.sin(.5*-Math.PI),n=Math.cos(.5*-Math.PI);r=s;let l=e-i;return a.setTransform(t*n,t*h,-t*h,t*n,t*(r+l*h-r*n),t*(l-l*n-r*h)),a.drawImage(this._cnvBorder,r,l),h=Math.sin(.5*Math.PI),n=Math.cos(.5*Math.PI),r=e-s,l=i,a.setTransform(t*n,t*h,-t*h,t*n,t*(r+l*h-r*n),t*(l-l*n-r*h)),a.drawImage(this._cnvBorder,js13k.Renderer.res-s,i),a.setTransform(t,0,0,t,0,0),s}update(a){this.timer+=a,this.progress+=.015*a,this.progress>=1&&(this.border-=.4*a,this.border=Math.max(this.border,-22),-22===this.border&&(this.progressBorder+=.02*a)),this.isBlinking=(this.timer+100)%400<5}}js13k.Level.Outro=a}